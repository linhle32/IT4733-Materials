{"paragraphs":[{"text":"%md\n<h3> Loading Data </h3>\n\nChange the csv path to your correct file.","user":"anonymous","dateUpdated":"2023-01-25T01:14:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3> Loading Data </h3>\n<p>Change the csv path to your correct file.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674590841792_513878151","id":"20230124-200721_1933496500","dateCreated":"2023-01-24T20:07:21+0000","dateStarted":"2023-01-25T01:14:01+0000","dateFinished":"2023-01-25T01:14:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:64157"},{"text":"%spark2.pyspark\n\ndata = spark.read.options(header='True',inferSchema='True',delimiter=',').csv(\"/tmp/data/health_risk.csv\")\ndata.printSchema()","user":"anonymous","dateUpdated":"2023-01-25T01:54:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- PatientID: integer (nullable = true)\n |-- AccountID: integer (nullable = true)\n |-- Age: integer (nullable = true)\n |-- Height: double (nullable = true)\n |-- Weight: double (nullable = true)\n |-- Exercise: string (nullable = true)\n |-- Smoke: string (nullable = true)\n |-- Transportation: string (nullable = true)\n |-- Health Risk: integer (nullable = true)\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=2","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=3"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674569429439_-1414153687","id":"20230124-141029_1046446419","dateCreated":"2023-01-24T14:10:29+0000","dateStarted":"2023-01-25T01:54:11+0000","dateFinished":"2023-01-25T01:54:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64158"},{"text":"%spark2.pyspark\ndata.show()","user":"anonymous","dateUpdated":"2023-01-25T01:54:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+---+------+------+----------+-----+--------------------+-----------+\n| PatientID|AccountID|Age|Height|Weight|  Exercise|Smoke|      Transportation|Health Risk|\n+----------+---------+---+------+------+----------+-----+--------------------+-----------+\n|2023000001|   171910| 21|  1.62|  64.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000002|   162466| 21|  1.52|  56.0| Sometimes|  yes|Public_Transporta...|          0|\n|2023000003|   121203| 23|   1.8|  77.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000004|   175163| 27|   1.8|  87.0| Sometimes|   no|             Walking|          0|\n|2023000005|   196503| 22|  1.78|  89.8| Sometimes|   no|Public_Transporta...|          0|\n|2023000006|   104898| 29|  1.62|  53.0| Sometimes|   no|          Automobile|          0|\n|2023000007|   108644| 23|   1.5|  55.0| Sometimes|   no|           Motorbike|          0|\n|2023000008|   195583| 22|  1.64|  53.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000009|   126457| 24|  1.78|  64.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000010|   114966| 22|  1.72|  68.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000011|   199293| 26|  1.85| 105.0|Frequently|   no|Public_Transporta...|          1|\n|2023000012|   164491| 21|  1.72|  80.0|Frequently|   no|Public_Transporta...|          0|\n|2023000013|   152437| 22|  1.65|  56.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000014|   156725| 41|   1.8|  99.0| Sometimes|   no|          Automobile|          1|\n|2023000015|   126957| 23|  1.77|  60.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000016|   113829| 22|   1.7|  66.0|    Always|   no|Public_Transporta...|          0|\n|2023000017|   177699| 27|  1.93| 102.0| Sometimes|   no|Public_Transporta...|          0|\n|2023000018|   103718| 29|  1.53|  78.0| Sometimes|   no|          Automobile|          1|\n|2023000019|   165515| 30|  1.71|  82.0|Frequently|  yes|          Automobile|          0|\n|2023000020|   145479| 23|  1.65|  70.0| Sometimes|   no|Public_Transporta...|          0|\n+----------+---------+---+------+------+----------+-----+--------------------+-----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=4"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674574062373_-245237760","id":"20230124-152742_1484821132","dateCreated":"2023-01-24T15:27:42+0000","dateStarted":"2023-01-25T01:54:58+0000","dateFinished":"2023-01-25T01:55:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64159"},{"text":"%md\n\nModify the code below to include all integer columns in integer_cols (as strings). \n\nVerify with the schema that no columns are integer after casting (besides those that will be dropped anyway).","user":"anonymous","dateUpdated":"2023-01-25T01:17:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Modify the code below to include all integer columns in integer_cols (as strings). </p>\n<p>Verify with the schema that no columns are integer after casting (besides those that will be dropped anyway).</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674591396629_204317343","id":"20230124-201636_816637435","dateCreated":"2023-01-24T20:16:36+0000","dateStarted":"2023-01-25T01:17:45+0000","dateFinished":"2023-01-25T01:17:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64160"},{"text":"%spark2.pyspark\n\nfrom pyspark.sql.functions import col\nfrom pyspark.sql.types import DoubleType\n\ninteger_cols = ['Age', 'Health Risk']\n\nfor c in integer_cols:\n    data = data.withColumn(c, col(c).cast(DoubleType()))\n\ndata.printSchema()","user":"anonymous","dateUpdated":"2023-01-25T01:55:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- PatientID: integer (nullable = true)\n |-- AccountID: integer (nullable = true)\n |-- Age: double (nullable = true)\n |-- Height: double (nullable = true)\n |-- Weight: double (nullable = true)\n |-- Exercise: string (nullable = true)\n |-- Smoke: string (nullable = true)\n |-- Transportation: string (nullable = true)\n |-- Health Risk: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1674579525971_1750655063","id":"20230124-165845_1320819949","dateCreated":"2023-01-24T16:58:45+0000","dateStarted":"2023-01-25T01:55:41+0000","dateFinished":"2023-01-25T01:55:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64161"},{"text":"%md\n\nDrop all unneccessary columns in the paragraph below by including them in the drop_cols list. Verify with the result of printSchema(). \n\nIn general, ID columns and name columns should be dropped.","user":"anonymous","dateUpdated":"2023-01-25T01:17:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Drop all unneccessary columns in the paragraph below by including them in the drop_cols list. Verify with the result of printSchema(). </p>\n<p>In general, ID columns and name columns should be dropped.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674591501347_607488582","id":"20230124-201821_1344680715","dateCreated":"2023-01-24T20:18:21+0000","dateStarted":"2023-01-25T01:17:56+0000","dateFinished":"2023-01-25T01:17:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64162"},{"text":"%spark2.pyspark\n\ndrop_cols = ['PatientID', 'AccountID']\ndata_main = data.drop(*drop_cols)\ndata_main.printSchema()","user":"anonymous","dateUpdated":"2023-01-25T01:55:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Age: double (nullable = true)\n |-- Height: double (nullable = true)\n |-- Weight: double (nullable = true)\n |-- Exercise: string (nullable = true)\n |-- Smoke: string (nullable = true)\n |-- Transportation: string (nullable = true)\n |-- Health Risk: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1674573935894_1467754357","id":"20230124-152535_1737355475","dateCreated":"2023-01-24T15:25:35+0000","dateStarted":"2023-01-25T01:55:56+0000","dateFinished":"2023-01-25T01:55:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64163"},{"text":"%md\n\n<h3>Train Test Splitting</h3>\n\nChange the 0.7 - 0.3 ratio to other as needed","user":"anonymous","dateUpdated":"2023-01-25T01:18:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Train Test Splitting</h3>\n<p>Change the 0.7 - 0.3 ratio to other as needed</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674591743429_-31788407","id":"20230124-202223_283821740","dateCreated":"2023-01-24T20:22:23+0000","dateStarted":"2023-01-25T01:18:14+0000","dateFinished":"2023-01-25T01:18:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64164"},{"text":"%spark2.pyspark\n\ndata_train, data_test = data_main.randomSplit([0.7, 0.3])\n\ndata_train.count(), data_test.count()","user":"anonymous","dateUpdated":"2023-01-25T01:56:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(1512, 599)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=5","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=6"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674574030906_928682990","id":"20230124-152710_324354579","dateCreated":"2023-01-24T15:27:10+0000","dateStarted":"2023-01-25T01:56:18+0000","dateFinished":"2023-01-25T01:57:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64165"},{"text":"%md\n\n<h3>Processing Pipeline</h3>\n\nModify <b>string_cols</b>, <b>numeric_cols</b>, and <b>target</b> to include the correct column names.","user":"anonymous","dateUpdated":"2023-01-25T01:18:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Processing Pipeline</h3>\n<p>Modify <b>string_cols</b>, <b>numeric_cols</b>, and <b>target</b> to include the correct column names.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674593438816_-1767697978","id":"20230124-205038_993821482","dateCreated":"2023-01-24T20:50:38+0000","dateStarted":"2023-01-25T01:18:48+0000","dateFinished":"2023-01-25T01:18:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64166"},{"text":"%spark2.pyspark\nfrom pyspark.ml.feature import StringIndexer\nfrom pyspark.ml.feature import OneHotEncoder\nfrom pyspark.ml.feature import Imputer\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml import Pipeline\n\nstring_cols = ['Exercise', 'Smoke', 'Transportation']\nnumeric_cols = ['Age','Height','Weight']\ntarget = 'Health Risk'\n\nencoders = []\nfor c in string_cols:\n    encoders.append(StringIndexer(inputCol=c, outputCol=c+'Index', handleInvalid='keep'))\n    encoders.append(OneHotEncoder(inputCol=c+'Index', outputCol=c+'Codes'))\n\nimputer = Imputer(inputCols = numeric_cols, outputCols = [c+'Imp' for c in numeric_cols], strategy = 'median')\n\nassembler = VectorAssembler(inputCols=[c+'Codes' for c in string_cols]+[c+'Imp' for c in numeric_cols], outputCol='features')\n\npipeline = Pipeline(stages = encoders + [imputer, assembler])\n\npipeline_trained = pipeline.fit(data_train)","user":"anonymous","dateUpdated":"2023-01-25T01:58:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=7","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=8","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=9","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=10"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674580508039_861669709","id":"20230124-171508_406577413","dateCreated":"2023-01-24T17:15:08+0000","dateStarted":"2023-01-25T01:58:57+0000","dateFinished":"2023-01-25T02:00:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64167"},{"text":"%spark2.pyspark\n\ntrain_prc = pipeline_trained.transform(data_train).select(target,'features')\ntrain_prc.show()","user":"anonymous","dateUpdated":"2023-01-25T02:02:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=11","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=12","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=13"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674582776166_59547883","id":"20230124-175256_1002768516","dateCreated":"2023-01-24T17:52:56+0000","dateStarted":"2023-01-25T02:02:55+0000","dateFinished":"2023-01-25T02:03:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64168","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+\n|Health Risk|            features|\n+-----------+--------------------+\n|        0.0|(14,[0,6,11,12,13...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,7,11,12,...|\n|        1.0|(14,[0,4,7,11,12,...|\n|        0.0|(14,[0,4,8,11,12,...|\n|        0.0|(14,[1,4,6,11,12,...|\n|        0.0|(14,[2,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,8,11,12,...|\n|        1.0|(14,[1,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n+-----------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%spark2.pyspark\n\ntest_prc = pipeline_trained.transform(data_test).select(target,'features')\ntest_prc.show()","user":"anonymous","dateUpdated":"2023-01-25T02:03:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1674583580723_-136439887","id":"20230124-180620_157977192","dateCreated":"2023-01-24T18:06:20+0000","dateStarted":"2023-01-25T02:03:06+0000","dateFinished":"2023-01-25T02:03:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64169","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=14","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=15","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=16"],"interpreterSettingId":"spark2"}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+\n|Health Risk|            features|\n+-----------+--------------------+\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,7,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,8,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,8,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[1,4,6,11,12,...|\n|        0.0|(14,[1,4,6,11,12,...|\n|        0.0|(14,[0,4,8,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[2,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,6,11,12,...|\n|        1.0|(14,[0,4,6,11,12,...|\n|        0.0|(14,[0,4,8,11,12,...|\n+-----------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%md\n\n<h2>Modeling</h2>\n\nTraining a simple model and check its performance. This part will be updated in the next module","user":"anonymous","dateUpdated":"2023-01-25T02:03:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Modeling</h2>\n<p>Training a simple model and check its performance. This part will be updated in the next module</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674594746284_-64959756","id":"20230124-211226_580908956","dateCreated":"2023-01-24T21:12:26+0000","dateStarted":"2023-01-25T02:03:08+0000","dateFinished":"2023-01-25T02:03:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64170"},{"text":"%spark2.pyspark\n\nfrom pyspark.ml.classification import LogisticRegression\n\nlogistic_model = LogisticRegression(featuresCol='features', labelCol=target)\n\nlogistic_trained = logistic_model.fit(train_prc)","user":"anonymous","dateUpdated":"2023-01-25T02:04:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=17","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=18","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=19","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=20","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=21","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=22","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=23","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=24","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=25","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=26","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=27","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=28","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=29","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=30","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=31","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=32","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=33","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=34","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=35","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=36","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=37","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=38","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=39","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=40","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=41","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=42","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=43","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=44","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=45","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=46","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=47","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=48","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=49","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=50","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=51","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=52","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=53","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=54","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=55","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=56","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=57","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=58","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=59","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=60","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=61","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=62","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=63","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=64","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=65","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=66","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=67","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=68","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=69","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=70","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=71","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=72","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=73","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=74","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=75","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=76","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=77","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=78","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=79","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=80","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=81","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=82","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=83","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=84","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=85","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=86","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=87","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=88","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=89","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=90","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=91","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=92","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=93","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=94","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=95","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=96","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=97","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=98","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=99","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=100","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=101","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=102","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=103","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=104","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=105","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=106","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=107","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=108","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=109","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=110","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=111","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=112","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=113","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=114","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=115","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=116","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=117","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=118","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=119","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=120","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=121"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674583885413_-844084312","id":"20230124-181125_1302286594","dateCreated":"2023-01-24T18:11:25+0000","dateStarted":"2023-01-25T02:05:00+0000","dateFinished":"2023-01-25T02:07:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64171"},{"text":"%spark2.pyspark\ntrain_predicted = logistic_trained.transform(train_prc)\ntrain_predicted.crosstab(target, 'prediction').show()","user":"anonymous","dateUpdated":"2023-01-25T02:08:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+---+---+\n|Health Risk_prediction|0.0|1.0|\n+----------------------+---+---+\n|                   1.0|194|687|\n|                   0.0|403|228|\n+----------------------+---+---+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=122","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=123","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=124","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=125","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=126"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674585939021_1064502001","id":"20230124-184539_1694421190","dateCreated":"2023-01-24T18:45:39+0000","dateStarted":"2023-01-25T02:08:17+0000","dateFinished":"2023-01-25T02:09:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64172"},{"text":"%spark2.pyspark\ntest_predicted = logistic_trained.transform(test_prc)\ntest_predicted.crosstab(target, 'prediction').show()","user":"anonymous","dateUpdated":"2023-01-25T02:08:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+---+---+\n|Health Risk_prediction|0.0|1.0|\n+----------------------+---+---+\n|                   1.0| 87|276|\n|                   0.0|155| 81|\n+----------------------+---+---+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=127","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=128","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=129","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=130","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=131"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674585844254_-1826776567","id":"20230124-184404_527645336","dateCreated":"2023-01-24T18:44:04+0000","dateStarted":"2023-01-25T02:08:22+0000","dateFinished":"2023-01-25T02:09:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64173"},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2023-01-25T01:27:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1674610037868_-1009730379","id":"20230125-012717_1194748897","dateCreated":"2023-01-25T01:27:17+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:64174"}],"name":"assignment","id":"2HRZ96SKM","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}