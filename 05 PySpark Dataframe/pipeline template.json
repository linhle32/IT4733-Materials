{"paragraphs":[{"text":"%md\n<h3> Loading Data </h3>\n\nChange the csv path to your correct file.","user":"anonymous","dateUpdated":"2023-01-25T01:14:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3> Loading Data </h3>\n<p>Change the csv path to your correct file.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674590841792_513878151","id":"20230124-200721_1933496500","dateCreated":"2023-01-24T20:07:21+0000","dateStarted":"2023-01-25T01:14:01+0000","dateFinished":"2023-01-25T01:14:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:53961"},{"text":"%spark2.pyspark\n\ndata = spark.read.options(header='True',inferSchema='True',delimiter=',').csv(\"/tmp/data/heart_disease.csv\")\ndata.printSchema()","user":"anonymous","dateUpdated":"2023-01-25T01:14:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- PatientID: integer (nullable = true)\n |-- Age: integer (nullable = true)\n |-- ChestPainType: string (nullable = true)\n |-- RestingBP: integer (nullable = true)\n |-- Cholesterol: integer (nullable = true)\n |-- FastingBS: integer (nullable = true)\n |-- RestingECG: string (nullable = true)\n |-- MaxHR: integer (nullable = true)\n |-- ExerciseAngina: string (nullable = true)\n |-- Oldpeak: double (nullable = true)\n |-- ST_Slope: string (nullable = true)\n |-- HeartDisease: integer (nullable = true)\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=0","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=1"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674569429439_-1414153687","id":"20230124-141029_1046446419","dateCreated":"2023-01-24T14:10:29+0000","dateStarted":"2023-01-25T01:14:02+0000","dateFinished":"2023-01-25T01:17:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53962"},{"text":"%spark2.pyspark\ndata.show()","user":"anonymous","dateUpdated":"2023-01-25T01:17:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+---+-------------+---------+-----------+---------+----------+-----+--------------+-------+--------+------------+\n|PatientID|Age|ChestPainType|RestingBP|Cholesterol|FastingBS|RestingECG|MaxHR|ExerciseAngina|Oldpeak|ST_Slope|HeartDisease|\n+---------+---+-------------+---------+-----------+---------+----------+-----+--------------+-------+--------+------------+\n| 20230001| 40|          ATA|      140|        289|        0|    Normal|  172|             N|    0.0|      Up|           0|\n| 20230002| 49|          NAP|      160|        180|        0|    Normal|  156|             N|    1.0|    Flat|           1|\n| 20230003| 37|          ATA|      130|        283|        0|        ST|   98|             N|    0.0|      Up|           0|\n| 20230004| 48|          ASY|      138|        214|        0|    Normal|  108|             Y|    1.5|    Flat|           1|\n| 20230005| 54|          NAP|      150|        195|        0|    Normal|  122|             N|    0.0|      Up|           0|\n| 20230006| 39|          NAP|      120|        339|        0|    Normal|  170|             N|    0.0|      Up|           0|\n| 20230007| 45|          ATA|      130|        237|        0|    Normal|  170|             N|    0.0|      Up|           0|\n| 20230008| 54|          ATA|      110|        208|        0|    Normal|  142|             N|    0.0|      Up|           0|\n| 20230009| 37|          ASY|      140|        207|        0|    Normal|  130|             Y|    1.5|    Flat|           1|\n| 20230010| 48|          ATA|      120|        284|        0|    Normal|  120|             N|    0.0|      Up|           0|\n| 20230011| 37|          NAP|      130|        211|        0|    Normal|  142|             N|    0.0|      Up|           0|\n| 20230012| 58|          ATA|      136|        164|        0|        ST|   99|             Y|    2.0|    Flat|           1|\n| 20230013| 39|          ATA|      120|        204|        0|    Normal|  145|             N|    0.0|      Up|           0|\n| 20230014| 49|          ASY|      140|        234|        0|    Normal|  140|             Y|    1.0|    Flat|           1|\n| 20230015| 42|          NAP|      115|        211|        0|        ST|  137|             N|    0.0|      Up|           0|\n| 20230016| 54|          ATA|      120|        273|        0|    Normal|  150|             N|    1.5|    Flat|           0|\n| 20230017| 38|          ASY|      110|        196|        0|    Normal|  166|             N|    0.0|    Flat|           1|\n| 20230018| 43|          ATA|      120|        201|        0|    Normal|  165|             N|    0.0|      Up|           0|\n| 20230019| 60|          ASY|      100|        248|        0|    Normal|  125|             N|    1.0|    Flat|           1|\n| 20230020| 36|          ATA|      120|        267|        0|    Normal|  160|             N|    3.0|    Flat|           1|\n+---------+---+-------------+---------+-----------+---------+----------+-----+--------------+-------+--------+------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=2"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674574062373_-245237760","id":"20230124-152742_1484821132","dateCreated":"2023-01-24T15:27:42+0000","dateStarted":"2023-01-25T01:17:30+0000","dateFinished":"2023-01-25T01:17:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53963"},{"text":"%md\n\nModify the code below to include all integer columns in integer_cols (as strings). \n\nVerify with the schema that no columns are integer after casting (besides those that will be dropped anyway).","user":"anonymous","dateUpdated":"2023-01-25T01:17:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Modify the code below to include all integer columns in integer_cols (as strings). </p>\n<p>Verify with the schema that no columns are integer after casting (besides those that will be dropped anyway).</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674591396629_204317343","id":"20230124-201636_816637435","dateCreated":"2023-01-24T20:16:36+0000","dateStarted":"2023-01-25T01:17:45+0000","dateFinished":"2023-01-25T01:17:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53964"},{"text":"%spark2.pyspark\n\nfrom pyspark.sql.functions import col\nfrom pyspark.sql.types import DoubleType\n\ninteger_cols = ['Age', 'RestingBP', 'Cholesterol', 'FastingBS', 'MaxHR', 'HeartDisease']\n\nfor c in integer_cols:\n    data = data.withColumn(c, col(c).cast(DoubleType()))\n\ndata.printSchema()","user":"anonymous","dateUpdated":"2023-01-25T01:17:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- PatientID: integer (nullable = true)\n |-- Age: double (nullable = true)\n |-- ChestPainType: string (nullable = true)\n |-- RestingBP: double (nullable = true)\n |-- Cholesterol: double (nullable = true)\n |-- FastingBS: double (nullable = true)\n |-- RestingECG: string (nullable = true)\n |-- MaxHR: double (nullable = true)\n |-- ExerciseAngina: string (nullable = true)\n |-- Oldpeak: double (nullable = true)\n |-- ST_Slope: string (nullable = true)\n |-- HeartDisease: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1674579525971_1750655063","id":"20230124-165845_1320819949","dateCreated":"2023-01-24T16:58:45+0000","dateStarted":"2023-01-25T01:17:49+0000","dateFinished":"2023-01-25T01:17:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53965"},{"text":"%md\n\nDrop all unneccessary columns in the paragraph below by including them in the drop_cols list. Verify with the result of printSchema(). \n\nIn general, ID columns and name columns should be dropped.","user":"anonymous","dateUpdated":"2023-01-25T01:17:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Drop all unneccessary columns in the paragraph below by including them in the drop_cols list. Verify with the result of printSchema(). </p>\n<p>In general, ID columns and name columns should be dropped.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674591501347_607488582","id":"20230124-201821_1344680715","dateCreated":"2023-01-24T20:18:21+0000","dateStarted":"2023-01-25T01:17:56+0000","dateFinished":"2023-01-25T01:17:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53966"},{"text":"%spark2.pyspark\n\ndrop_cols = ['PatientID']\ndata_main = data.drop(*drop_cols)\ndata_main.printSchema()","user":"anonymous","dateUpdated":"2023-01-25T01:17:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Age: double (nullable = true)\n |-- ChestPainType: string (nullable = true)\n |-- RestingBP: double (nullable = true)\n |-- Cholesterol: double (nullable = true)\n |-- FastingBS: double (nullable = true)\n |-- RestingECG: string (nullable = true)\n |-- MaxHR: double (nullable = true)\n |-- ExerciseAngina: string (nullable = true)\n |-- Oldpeak: double (nullable = true)\n |-- ST_Slope: string (nullable = true)\n |-- HeartDisease: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1674573935894_1467754357","id":"20230124-152535_1737355475","dateCreated":"2023-01-24T15:25:35+0000","dateStarted":"2023-01-25T01:18:04+0000","dateFinished":"2023-01-25T01:18:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53967"},{"text":"%md\n\n<h3>Train Test Splitting</h3>\n\nChange the 0.7 - 0.3 ratio to other as needed","user":"anonymous","dateUpdated":"2023-01-25T01:18:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Train Test Splitting</h3>\n<p>Change the 0.7 - 0.3 ratio to other as needed</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674591743429_-31788407","id":"20230124-202223_283821740","dateCreated":"2023-01-24T20:22:23+0000","dateStarted":"2023-01-25T01:18:14+0000","dateFinished":"2023-01-25T01:18:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53968"},{"text":"%spark2.pyspark\n\ndata_train, data_test = data_main.randomSplit([0.7, 0.3])\n\ndata_train.count(), data_test.count()","user":"anonymous","dateUpdated":"2023-01-25T01:18:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(640, 278)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=3","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=4"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674574030906_928682990","id":"20230124-152710_324354579","dateCreated":"2023-01-24T15:27:10+0000","dateStarted":"2023-01-25T01:18:15+0000","dateFinished":"2023-01-25T01:18:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53969"},{"text":"%md\n\n<h3>Processing Pipeline</h3>\n\nModify <b>string_cols</b>, <b>numeric_cols</b>, and <b>target</b> to include the correct column names.","user":"anonymous","dateUpdated":"2023-01-25T01:18:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Processing Pipeline</h3>\n<p>Modify <b>string_cols</b>, <b>numeric_cols</b>, and <b>target</b> to include the correct column names.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674593438816_-1767697978","id":"20230124-205038_993821482","dateCreated":"2023-01-24T20:50:38+0000","dateStarted":"2023-01-25T01:18:48+0000","dateFinished":"2023-01-25T01:18:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53970"},{"text":"%spark2.pyspark\nfrom pyspark.ml.feature import StringIndexer\nfrom pyspark.ml.feature import OneHotEncoder\nfrom pyspark.ml.feature import Imputer\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml import Pipeline\n\nstring_cols = ['ChestPainType', 'RestingECG', 'ExerciseAngina', 'ST_Slope']\nnumeric_cols = ['Age','RestingBP','Cholesterol','FastingBS','MaxHR','Oldpeak']\ntarget = 'HeartDisease'\n\nencoders = []\nfor c in string_cols:\n    encoders.append(StringIndexer(inputCol=c, outputCol=c+'Index', handleInvalid='keep'))\n    encoders.append(OneHotEncoder(inputCol=c+'Index', outputCol=c+'Codes'))\n\nimputer = Imputer(inputCols = numeric_cols, outputCols = [c+'Imp' for c in numeric_cols], strategy = 'median')\n\nassembler = VectorAssembler(inputCols=[c+'Codes' for c in string_cols]+[c+'Imp' for c in numeric_cols], outputCol='features')\n\npipeline = Pipeline(stages = encoders + [imputer, assembler])\n\npipeline_trained = pipeline.fit(data_train)","user":"anonymous","dateUpdated":"2023-01-25T01:18:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=5","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=6","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=7","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=8","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=9"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674580508039_861669709","id":"20230124-171508_406577413","dateCreated":"2023-01-24T17:15:08+0000","dateStarted":"2023-01-25T01:18:58+0000","dateFinished":"2023-01-25T01:20:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53971"},{"text":"%spark2.pyspark\n\ntrain_prc = pipeline_trained.transform(data_train).select(target,'features')\ntrain_prc.show()","user":"anonymous","dateUpdated":"2023-01-25T01:20:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+\n|HeartDisease|            features|\n+------------+--------------------+\n|         0.0|(18,[1,5,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[1,5,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[3,6,7,10,12,...|\n|         1.0|(18,[0,4,8,9,12,1...|\n|         0.0|(18,[1,6,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         1.0|(18,[3,4,7,10,12,...|\n|         1.0|(18,[0,4,8,9,12,1...|\n|         1.0|(18,[0,4,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[3,5,7,10,12,...|\n|         1.0|(18,[0,4,8,9,12,1...|\n|         1.0|(18,[0,5,8,10,12,...|\n|         0.0|(18,[0,4,7,10,12,...|\n|         1.0|(18,[1,4,7,9,12,1...|\n|         0.0|(18,[1,5,7,10,12,...|\n+------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=10","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=11","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=12"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674582776166_59547883","id":"20230124-175256_1002768516","dateCreated":"2023-01-24T17:52:56+0000","dateStarted":"2023-01-25T01:20:57+0000","dateFinished":"2023-01-25T01:21:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53972"},{"text":"%spark2.pyspark\n\ntest_prc = pipeline_trained.transform(data_test).select(target,'features')\ntest_prc.show()","user":"anonymous","dateUpdated":"2023-01-25T01:21:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+\n|HeartDisease|            features|\n+------------+--------------------+\n|         1.0|(18,[0,4,7,9,12,1...|\n|         0.0|(18,[2,4,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[1,6,7,10,12,...|\n|         1.0|(18,[3,4,7,9,12,1...|\n|         1.0|(18,[0,4,8,9,12,1...|\n|         0.0|(18,[0,4,7,10,12,...|\n|         0.0|(18,[3,6,7,10,12,...|\n|         1.0|(18,[1,4,7,9,12,1...|\n|         0.0|(18,[2,4,7,9,12,1...|\n|         0.0|(18,[2,4,7,10,12,...|\n|         0.0|(18,[0,4,7,10,12,...|\n|         0.0|(18,[1,4,7,10,12,...|\n|         0.0|(18,[1,6,7,10,12,...|\n|         0.0|(18,[2,5,7,9,12,1...|\n|         0.0|(18,[2,4,7,10,12,...|\n|         0.0|(18,[2,4,7,11,12,...|\n|         1.0|(18,[0,4,8,9,12,1...|\n|         1.0|(18,[0,4,7,9,12,1...|\n+------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=13","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=14","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=15"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674583580723_-136439887","id":"20230124-180620_157977192","dateCreated":"2023-01-24T18:06:20+0000","dateStarted":"2023-01-25T01:21:53+0000","dateFinished":"2023-01-25T01:22:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53973"},{"text":"%md\n\n<h2>Modeling</h2>\n\nTraining a simple model and check its performance. This part will be updated in the next module","user":"anonymous","dateUpdated":"2023-01-25T01:22:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Modeling</h2>\n<p>Training a simple model and check its performance. This part will be updated in the next module</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1674594746284_-64959756","id":"20230124-211226_580908956","dateCreated":"2023-01-24T21:12:26+0000","dateStarted":"2023-01-25T01:22:25+0000","dateFinished":"2023-01-25T01:22:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53974"},{"text":"%spark2.pyspark\n\nfrom pyspark.ml.classification import LogisticRegression\n\nlogistic_model = LogisticRegression(featuresCol='features', labelCol=target)\n\nlogistic_trained = logistic_model.fit(train_prc)","user":"anonymous","dateUpdated":"2023-01-25T01:22:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=16","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=17","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=18","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=19","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=20","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=21","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=22","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=23","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=24","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=25","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=26","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=27","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=28","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=29","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=30","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=31","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=32","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=33","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=34","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=35","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=36","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=37","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=38","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=39","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=40","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=41","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=42","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=43","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=44","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=45","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=46","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=47","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=48","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=49","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=50","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=51","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=52","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=53","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=54","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=55"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674583885413_-844084312","id":"20230124-181125_1302286594","dateCreated":"2023-01-24T18:11:25+0000","dateStarted":"2023-01-25T01:22:30+0000","dateFinished":"2023-01-25T01:25:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53975"},{"text":"%spark2.pyspark\ntrain_predicted = logistic_trained.transform(train_prc)\ntrain_predicted.crosstab(target, 'prediction').show()","user":"anonymous","dateUpdated":"2023-01-25T01:25:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------+---+---+\n|HeartDisease_prediction|0.0|1.0|\n+-----------------------+---+---+\n|                    1.0| 33|327|\n|                    0.0|240| 40|\n+-----------------------+---+---+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=56","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=57","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=58","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=59","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=60"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674585939021_1064502001","id":"20230124-184539_1694421190","dateCreated":"2023-01-24T18:45:39+0000","dateStarted":"2023-01-25T01:25:59+0000","dateFinished":"2023-01-25T01:27:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53976"},{"text":"%spark2.pyspark\ntest_predicted = logistic_trained.transform(test_prc)\ntest_predicted.crosstab(target, 'prediction').show()","user":"anonymous","dateUpdated":"2023-01-25T01:27:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------+---+---+\n|HeartDisease_prediction|0.0|1.0|\n+-----------------------+---+---+\n|                    1.0| 23|125|\n|                    0.0|103| 27|\n+-----------------------+---+---+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=61","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=62","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=63","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=64","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=65"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1674585844254_-1826776567","id":"20230124-184404_527645336","dateCreated":"2023-01-24T18:44:04+0000","dateStarted":"2023-01-25T01:27:24+0000","dateFinished":"2023-01-25T01:27:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53977"},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2023-01-25T01:27:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1674610037868_-1009730379","id":"20230125-012717_1194748897","dateCreated":"2023-01-25T01:27:17+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:53978"}],"name":"pipeline template","id":"2HRZ96SKM","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}